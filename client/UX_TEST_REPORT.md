# SoDEX 用户体验测试报告

**测试日期:** 2026-01-20
**测试方法:** 代码审查 + 功能逻辑分析
**测试范围:** PRD 文档中列出的所有已实现功能

---

## 测试总览

| 功能模块 | 测试项数 | 通过 | 问题 | 评分 |
|---------|---------|------|------|------|
| 登录系统 | 5 | 3 | 2 | ⭐⭐⭐ |
| 等级系统 | 10 | 7 | 3 | ⭐⭐⭐⭐ |
| 能量系统 | 8 | 5 | 3 | ⭐⭐⭐ |
| AI Cat 助手 | 6 | 5 | 1 | ⭐⭐⭐⭐ |
| 聊天面板 | 8 | 6 | 2 | ⭐⭐⭐⭐ |
| 路演日历 | 7 | 4 | 3 | ⭐⭐⭐ |
| 直播模态框 | 10 | 9 | 1 | ⭐⭐⭐⭐⭐ |
| 研报系统 | 6 | 5 | 1 | ⭐⭐⭐⭐ |
| 移动端适配 | 5 | 4 | 1 | ⭐⭐⭐⭐ |

**总体评分: 3.8 / 5**

---

## 1. 登录系统测试

### 1.1 测试项目

| 测试项 | 预期结果 | 实际结果 | 状态 |
|--------|---------|---------|------|
| 钱包地址输入 | 可输入任意格式 | ✓ 正常 | ✅ |
| 空地址提交 | 显示提示 | ✓ alert 提示 | ✅ |
| 快速演示登录 | 使用预设地址登录 | ✓ 正常 | ✅ |
| 语言切换 | 中英文切换 | ⚠️ 部分文案硬编码 | ⚠️ |
| 登录后跳转 | 进入交易界面 | ✓ 正常 | ✅ |

### 1.2 发现的问题

**问题 1: 钱包地址无格式验证**
```
位置: App.tsx:89-98
现象: 任意字符串都能登录
影响: 数据质量
严重程度: 低 (演示阶段可接受)
```

**问题 2: 登录后无新用户引导**
```
位置: App.tsx
现象: 登录后直接进入交易界面，新用户迷茫
影响: 用户激活率
严重程度: 高
建议: 添加新手引导流程
```

### 1.3 用户体验评估

**优点:**
- 登录流程简洁
- 快速演示按钮方便测试
- 语言切换功能完整

**缺点:**
- 缺少注册说明
- 缺少钱包连接方式 (MetaMask等)
- 无密码/2FA

---

## 2. 等级系统测试

### 2.1 测试项目

| 测试项 | 预期结果 | 实际结果 | 状态 |
|--------|---------|---------|------|
| 等级徽章显示 | TopNav 显示当前等级 | ✓ 显示图标+文字+进度条 | ✅ |
| 等级下拉框 | 点击展开详情 | ✓ 显示完整信息 | ✅ |
| 进度条显示 | 显示升级进度 | ✓ 百分比+目标等级 | ✅ |
| Boost 显示 | 显示 SoSo 加成 | ✓ 0% 时灰色显示 | ✅ |
| Shield 显示 | 显示 SSI 保护 | ✓ 0 时灰色显示 | ✅ |
| 模拟交易 | 可选择类型和金额 | ✓ 现货/合约 + 快捷金额 | ✅ |
| 能量历史 | 显示交易记录 | ✓ 有空状态和列表 | ✅ |
| 升级计算 | 达到门槛自动升级 | ⚠️ 需手动刷新页面 | ⚠️ |
| 进度数字 | 显示具体金额 | ❌ 只显示百分比 | ❌ |
| 移动端适配 | 全屏显示 | ✓ 已适配 | ✅ |

### 2.2 发现的问题

**问题 1: 等级升级不实时**
```
位置: userStore.ts:293-359
现象: simulateTrade 后 levelUpgrade 状态更新，但需要有 LevelUpgradeModal 组件监听
实际: LevelUpgradeModal 存在且会弹出
验证: 代码逻辑正确，需实际测试确认
```

**问题 2: 进度条只显示百分比**
```
位置: TopNav.tsx
现象: 显示 "63% → Gold" 但不显示具体金额
用户困惑: "还差多少钱升级？"
建议: 添加 "还需 $XX 手续费"
```

**问题 3: Boost/Shield 解释不够详细**
```
位置: TopNav.tsx:266-330
现象: 鼠标悬停可看到说明
问题: 移动端无法悬停，看不到说明
建议: 移动端改为点击展开
```

### 2.3 等级权益验证

| 等级 | 门槛 | 权益检查 |
|------|-----|---------|
| Bronze | $0 | AI客服 ✓ |
| Silver | $200 | AI研究员 ✓ (实际还是AI) |
| Gold | $1,000 | 专属研究员 ✓ hasResearcherAccess: true |
| Diamond | $5,000 | VIP研究员 ✓ |

**代码验证:**
```typescript
// types/index.ts
export const LEVEL_CONFIG: Record<UserLevel, LevelConfig> = {
  Bronze: { minFees: 0, maxFees: 200, hasResearcherAccess: false, ... },
  Silver: { minFees: 200, maxFees: 1000, hasResearcherAccess: false, ... },
  Gold: { minFees: 1000, maxFees: 5000, hasResearcherAccess: true, ... },
  Diamond: { minFees: 5000, maxFees: Infinity, hasResearcherAccess: true, ... },
};
```

---

## 3. 能量系统测试

### 3.1 测试项目

| 测试项 | 预期结果 | 实际结果 | 状态 |
|--------|---------|---------|------|
| 能量显示 | TopNav 显示可用能量 | ✓ 两位小数 | ✅ |
| 能量铸造 | 交易后增加能量 | ✓ 手续费1:1 | ✅ |
| Boost 加成 | 持有 SoSo 额外加成 | ✓ 最高10% | ✅ |
| 能量锁定 | 服务预扣 | ✓ lockEnergy 函数 | ✅ |
| 能量消耗 | 服务完成后消耗 | ✓ spendEnergy 函数 | ✅ |
| 能量衰减 | 每周 10% | ⚠️ 需手动调用 applyDecay | ⚠️ |
| Shield 保护 | 部分能量不衰减 | ✓ 代码正确 | ✅ |
| 能量历史 | 记录所有变动 | ⚠️ 只显示30天 | ⚠️ |

### 3.2 发现的问题

**问题 1: 能量衰减未自动执行**
```
位置: userStore.ts:232-276
现象: applyDecay 需要手动调用
问题: 没有定时器自动执行衰减
建议: 添加登录时检查 + 定时任务
```

**问题 2: 能量用途不明确**
```
现象: 用户不知道能量能干什么
当前用途:
- 研究员咨询: 10 能量/次 (代码中硬编码)
- 延续对话: 5 能量/轮
- 直播礼物: 10-1000 能量

问题: 这些规则没有在 UI 中说明
```

**问题 3: 交易后无能量反馈**
```
位置: TopNav.tsx 模拟交易区域
现象: 点击快捷金额后，只更新数字，无明显提示
建议: 添加 "+XX 能量" 浮动提示
```

### 3.3 能量计算验证

```typescript
// 验证现货 Taker 交易 $10,000
fee = 10000 * 0.0007 = $7.00
energyMinted = 7.00 * 1.0 = 7.00 能量 (无Boost)
energyMinted = 7.00 * 1.1 = 7.70 能量 (10% Boost)

// 代码正确
```

---

## 4. AI Cat 助手测试

### 4.1 测试项目

| 测试项 | 预期结果 | 实际结果 | 状态 |
|--------|---------|---------|------|
| 按钮位置 | 右下角浮动 | ✓ 固定定位 | ✅ |
| 等级图标 | 根据等级变化 | ✓ RoboCatIcon 组件 | ✅ |
| 服务类型标识 | Bronze/Silver=Bot, Gold+=Users | ✓ 正确判断 | ✅ |
| 悬停提示 | 显示服务说明 | ✓ 桌面端显示 | ✅ |
| 升级特效 | levelUpgrade 时闪烁 | ✓ Sparkles 动画 | ✅ |
| 移动端位置 | 底部靠右 | ⚠️ 可能被遮挡 | ⚠️ |

### 4.2 发现的问题

**问题 1: 移动端可能被其他元素遮挡**
```
位置: AICatButton/index.tsx:42
代码: className="fixed bottom-20 right-4 md:bottom-24 md:right-8 z-[100]"
问题: bottom-20 (80px) 可能不够，取决于其他固定元素
建议: 实际设备测试
```

### 4.3 功能逻辑验证

```typescript
// AICatButton/index.tsx:36
const hasResearcherAccess = user && userLevel
  ? LEVEL_CONFIG[userLevel]?.hasResearcherAccess
  : false;

// Bronze/Silver: hasResearcherAccess = false → 显示 Bot 图标
// Gold/Diamond: hasResearcherAccess = true → 显示 Users 图标
// 验证通过 ✓
```

---

## 5. 聊天面板测试

### 5.1 测试项目

| 测试项 | 预期结果 | 实际结果 | 状态 |
|--------|---------|---------|------|
| 打开/关闭 | 点击 Cat 打开，点击 X 关闭 | ✓ 正常 | ✅ |
| Tab 切换 | AI / 专属研究员 | ✓ 正常 | ✅ |
| AI 对话 | 可发送消息 | ✓ AIChat 组件 | ✅ |
| 研究员锁定 | 非 Gold 显示锁定 | ✓ Lock 图标 | ✅ |
| 体验券显示 | 有券时显示标识 | ✓ 闪烁绿色标签 | ✅ |
| 等级弹窗 | 点击锁定 Tab 弹出 | ✓ LevelProgressModal | ✅ |
| 点击外部关闭 | 点击面板外关闭 | ✓ useEffect 监听 | ✅ |
| 移动端全屏 | 宽高100% | ⚠️ h-[100dvh] 可能有兼容性问题 | ⚠️ |

### 5.2 发现的问题

**问题 1: 研究员服务流程复杂**
```
当前流程:
1. 点击 Cat 按钮
2. 面板打开，默认 AI Tab
3. 点击 "专属研究员" Tab
4. 如果非 Gold: 弹出 LevelProgressModal
5. 如果有体验券: 点击 "免费体验" 按钮
6. 进入 AskingPhase
7. 输入问题
8. 等待匹配
9. 选择研究员
10. 开始对话

问题: 步骤太多，用户可能中途放弃
```

**问题 2: 体验券位置不明显**
```
位置: ChatPanel/index.tsx:501-506
代码:
<span className="absolute -top-1 -right-1 px-1.5 py-0.5 text-[9px] font-bold bg-[var(--brand-green)] text-black rounded-full animate-pulse">
  {t('chat.trialVoucher')}
</span>

问题:
- 标签很小 (9px)
- 位于 Tab 右上角，容易被忽略
- 没有在 TopNav 中显示
```

### 5.3 研究员咨询流程测试

| 阶段 | 组件 | 验证结果 |
|------|------|---------|
| 提问 | AskingPhase | ✓ 有快捷模板 |
| 等待 | WaitingPhase | ✓ 显示加载动画 |
| 选择 | SelectingPhase | ✓ 显示研究员列表 |
| 对话 | ChattingPhase | ✓ 3轮对话限制 |
| 评分 | RatingPhase | ✓ 星级评分 |
| 完成 | CompletedPhase | ✓ 显示总结 |

---

## 6. 路演日历测试

### 6.1 测试项目

| 测试项 | 预期结果 | 实际结果 | 状态 |
|--------|---------|---------|------|
| 日历入口 | Ticker 中有日历按钮 | ✓ 路演日历按钮 | ✅ |
| 日历网格 | 显示月历 | ✓ 桌面端显示 | ✅ |
| 事件列表 | 显示即将到来的事件 | ✓ 有列表视图 | ✅ |
| 事件类型 | 宏观/路演/加密 | ⚠️ Toggle 切换 | ⚠️ |
| 报名功能 | 可添加到日历 | ✓ Apple/Google/Reminder | ✅ |
| 等级限制 | Gold/Diamond 显示锁 | ✓ 有 Crown 图标 | ✅ |
| 状态持久化 | 刷新后保留报名 | ❌ 组件状态，刷新丢失 | ❌ |

### 6.2 发现的问题

**问题 1: 报名状态不持久化**
```
位置: RoadshowCalendar.tsx
现象: registeredRoadshows 是 useState
问题: 刷新页面后报名状态丢失
建议: 使用 localStorage 或后端存储
```

**问题 2: 宏观日历和路演日历切换**
```
位置: RoadshowCalendar.tsx
现象: 有 macroTab 状态切换
问题: 切换逻辑可能不够清晰
需要实际运行验证
```

**问题 3: 没有提醒通知系统**
```
现象: 可以设置提醒，但只是生成 .ics 文件
问题: SoDEX 本身没有推送通知能力
建议: 实现浏览器通知 API
```

### 6.3 事件数据验证

```typescript
// RoadshowTicker.tsx - 路演事件
mockRoadshowEvents: [
  { id: 'rs-live-001', title: 'BTC 实时行情解读', isLive: true, ... },
  { id: 'rs-001', title: 'BTC 2025年行情展望', ... },
  ...
]

// RoadshowCalendar.tsx - 宏观事件
mockMacroEvents: [
  { title: 'FOMC利率决议', type: 'central_bank', ... },
  { title: '美国1月CPI数据', type: 'economic', ... },
  ...
]

// 数据完整 ✓
```

---

## 7. 直播模态框测试

### 7.1 测试项目

| 测试项 | 预期结果 | 实际结果 | 状态 |
|--------|---------|---------|------|
| 打开方式 | 点击 LIVE 标签 | ✓ onOpenLive 回调 | ✅ |
| 视频区域 | 显示模拟播放器 | ✓ 有播放/暂停/音量 | ✅ |
| 评论列表 | 实时滚动 | ✓ 自动滚动到底部 | ✅ |
| 发送评论 | 输入并发送 | ✓ 有输入框和发送按钮 | ✅ |
| 点赞功能 | 点击增加数量 | ✓ 有飘心动画 | ✅ |
| 礼物面板 | 显示礼物选项 | ✓ 6种礼物 | ✅ |
| 火箭特效 | 多发并行 | ✓ 5-10个火箭 | ✅ |
| 全局广播 | 大额礼物横幅 | ✓ 4秒显示 | ✅ |
| 最小化 | 缩小到右下角 | ✓ 有迷你视图 | ✅ |
| 模拟评论 | 自动添加评论 | ⚠️ 间隔可能太快 | ⚠️ |

### 7.2 发现的问题

**问题 1: 模拟评论频率可能过高**
```
位置: RoadshowLiveModal.tsx:119-143
代码: setInterval(() => { ... }, 2000 + Math.random() * 2000);
现象: 每 2-4 秒可能添加评论和礼物
问题: 可能让用户觉得不真实
建议: 降低频率或添加随机性
```

### 7.3 礼物系统验证

```typescript
const GIFTS = [
  { id: 'like', name: '点赞', icon: '👍', cost: 0, isBig: false },
  { id: 'rocket', name: '火箭', icon: '🚀', cost: 10, isBig: false },
  { id: 'diamond', name: '钻石', icon: '💎', cost: 50, isBig: true },
  { id: 'crown', name: '皇冠', icon: '👑', cost: 100, isBig: true },
  { id: 'lambo', name: '兰博基尼', icon: '🏎️', cost: 500, isBig: true },
  { id: 'spaceship', name: '飞船', icon: '🛸', cost: 1000, isBig: true },
];

// 验证:
// - 免费: 点赞 ✓
// - 普通: 火箭 (触发火箭动画) ✓
// - 大额: 钻石/皇冠/兰博基尼/飞船 (触发全局广播) ✓
```

---

## 8. 研报系统测试

### 8.1 测试项目

| 测试项 | 预期结果 | 实际结果 | 状态 |
|--------|---------|---------|------|
| 推送通知 | 登录后弹出 | ✓ 10秒后推送 | ✅ |
| 通知样式 | 右上角卡片 | ✓ 有进度条和关闭 | ✅ |
| 等级限制 | 非 Gold 显示锁定 | ✓ 显示升级提示 | ✅ |
| 研报详情 | 点击查看全文 | ✓ 有摘要和正文 | ✅ |
| AI 解读 | 逐条显示 | ✓ 有加载动画 | ✅ |
| 订阅作者 | 可点击订阅 | ⚠️ 只改变按钮状态 | ⚠️ |

### 8.2 发现的问题

**问题 1: 订阅功能未真正实现**
```
位置: ResearchReportModal.tsx:442-451
代码: const [isSubscribed, setIsSubscribed] = useState(false);
问题: 只是本地状态，刷新后丢失，没有存储
```

### 8.3 研报内容验证

```typescript
// 测试研报 r1
mockReportDetails['r1'] = {
  title: 'BTC Technical Analysis: Key Support at $94,500',
  sentiment: 'bullish', // 看多标签 ✓
  requiredLevel: 'Gold', // Gold+ 可见 ✓
  content: '## 核心观点 ...' // Markdown 格式 ✓
}

// AI 解读验证
mockAIInterpretations['r1'] = [
  '这份研报看多 BTC，核心逻辑是技术面支撑有效。',
  '从链上数据看，交易所 BTC 余额持续下降是积极信号。',
  ...
]
// 逐条显示 ✓
```

---

## 9. 移动端适配测试

### 9.1 测试项目

| 组件 | 桌面端 | 移动端 | 适配状态 |
|------|--------|--------|---------|
| TopNav 等级下拉框 | 480px 下拉 | 全屏 | ✅ |
| ChatPanel | 520x720px | 全屏 h-[100dvh] | ✅ |
| RoadshowCalendar | 有日历网格 | 只有列表 | ✅ |
| RoadshowLiveModal | 弹窗 | 全屏 | ✅ |
| AICatButton | bottom-24 right-8 | bottom-20 right-4 | ✅ |

### 9.2 发现的问题

**问题 1: 100dvh 兼容性**
```
位置: ChatPanel/index.tsx:415
代码: h-[100dvh]
问题: dvh 单位在旧浏览器不支持
建议: 添加 fallback: h-full 或 h-screen
```

---

## 10. 点击外部关闭测试

### 10.1 测试项目

| 组件 | 实现方式 | 验证结果 |
|------|---------|---------|
| ChatPanel | useRef + mousedown | ✓ 延迟100ms |
| TopNav 等级下拉框 | useRef + mousedown | ✓ 延迟100ms |
| RoadshowCalendar | backdrop click | ✓ 点击遮罩关闭 |
| RoadshowLiveModal | useRef + mousedown | ✓ 非最小化时有效 |
| ResearchReportModal | useRef + mousedown | ✓ |
| 语言切换下拉框 | 全屏遮罩 | ✓ |

**所有点击外部关闭功能验证通过 ✓**

---

## 11. 问题汇总

### 11.1 高优先级问题 (影响核心功能)

| # | 问题 | 位置 | 影响 |
|---|------|------|------|
| 1 | 体验券入口不明显 | ChatPanel | 新用户转化率 |
| 2 | 报名状态不持久 | RoadshowCalendar | 用户信任 |
| 3 | 能量系统无说明 | 全局 | 用户理解 |
| 4 | 无新手引导 | App.tsx | 用户激活 |

### 11.2 中优先级问题 (影响体验)

| # | 问题 | 位置 | 影响 |
|---|------|------|------|
| 5 | 进度只显示百分比 | TopNav | 用户动力 |
| 6 | 移动端 Tooltip 不可用 | TopNav | 信息获取 |
| 7 | 能量衰减无提醒 | userStore | 用户损失 |
| 8 | 订阅未持久化 | ResearchReportModal | 功能完整性 |

### 11.3 低优先级问题 (优化项)

| # | 问题 | 位置 | 影响 |
|---|------|------|------|
| 9 | 模拟评论频率过高 | RoadshowLiveModal | 真实感 |
| 10 | 100dvh 兼容性 | ChatPanel | 旧设备 |
| 11 | 钱包地址无验证 | App.tsx | 数据质量 |

---

## 12. 测试结论

### 12.1 整体评价

SoDEX 作为一个演示版本，核心功能基本完整，UI 设计精美，动画效果丰富。但在用户引导、状态持久化、信息透明度方面还有明显不足。

### 12.2 优势

1. **视觉设计**: 深色主题 + 渐变色 + 动画，符合加密交易平台风格
2. **功能完整**: 等级/能量/研究员/直播/研报 形成闭环
3. **响应式**: 移动端适配较好
4. **交互细节**: 点击外部关闭、悬停提示、加载动画

### 12.3 改进方向

1. **用户引导**: 添加新手教程，解释核心机制
2. **状态持久化**: 报名、订阅等状态需要存储
3. **信息透明**: 能量规则、升级条件需要清晰展示
4. **通知系统**: 实现浏览器推送通知

---

## 附录: 测试用例脚本

### A1. 登录测试

```
步骤:
1. 打开页面
2. 输入钱包地址: 0x1234...
3. 点击连接钱包
4. 验证进入交易界面
预期: 成功登录，显示交易界面
```

### A2. 等级升级测试

```
步骤:
1. 登录后点击等级徽章
2. 在模拟交易区选择"现货" + "Taker"
3. 连续点击 $100k 交易 10次
4. 观察等级变化
预期: Bronze → Silver → Gold
```

### A3. 研究员咨询测试

```
步骤:
1. 登录 (初始 Bronze)
2. 点击 AI Cat 按钮
3. 点击"专属研究员"Tab
4. 观察弹出的 LevelProgressModal
5. 点击"免费体验"
6. 输入问题并提交
预期: 进入等待阶段，显示加载动画
```

---

*测试报告由 Claude AI 生成*
*基于代码静态分析*
